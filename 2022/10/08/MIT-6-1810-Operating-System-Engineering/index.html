<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>MIT 6.1810 Operating System Engineering | 潇十七</title><meta name="keywords" content="MIT 6.1810,操作系统"><meta name="author" content="潇十七"><meta name="copyright" content="潇十七"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="课程地址:https:&#x2F;&#x2F;pdos.csail.mit.edu&#x2F;6.1810&#x2F;2022&#x2F;index.html  新坑，MIT 6.1810  # 6.1810 2022 Lecture 1: O&#x2F;S overview OverviewClass structureIntroduction to UNIX system callsexamples# Overview 6.1810 goalsUnd">
<meta property="og:type" content="article">
<meta property="og:title" content="MIT 6.1810 Operating System Engineering">
<meta property="og:url" content="https://x-17.top/2022/10/08/MIT-6-1810-Operating-System-Engineering/index.html">
<meta property="og:site_name" content="潇十七">
<meta property="og:description" content="课程地址:https:&#x2F;&#x2F;pdos.csail.mit.edu&#x2F;6.1810&#x2F;2022&#x2F;index.html  新坑，MIT 6.1810  # 6.1810 2022 Lecture 1: O&#x2F;S overview OverviewClass structureIntroduction to UNIX system callsexamples# Overview 6.1810 goalsUnd">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.dmoe.cc/random.php">
<meta property="article:published_time" content="2022-10-08T12:22:17.000Z">
<meta property="article:modified_time" content="2022-10-12T04:32:30.687Z">
<meta property="article:author" content="潇十七">
<meta property="article:tag" content="MIT 6.1810">
<meta property="article:tag" content="操作系统">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.dmoe.cc/random.php"><link rel="shortcut icon" href="/img/0.jpg"><link rel="canonical" href="https://x-17.top/2022/10/08/MIT-6-1810-Operating-System-Engineering/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 潇十七","link":"链接: ","source":"来源: 潇十七","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MIT 6.1810 Operating System Engineering',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2022-10-12 12:32:30'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"><link rel="stylesheet" href="/css/mo.css?version=2"><link rel="stylesheet" href="font-awesome-animation.min.css"><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-clock/lib/clock.min.css" /><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/0.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">165</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://www.dmoe.cc/random.php')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">潇十七</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MIT 6.1810 Operating System Engineering</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-10-08T12:22:17.000Z" title="发表于 2022-10-08 20:22:17">2022-10-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-10-12T04:32:30.687Z" title="更新于 2022-10-12 12:32:30">2022-10-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">计算机基础</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>34分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="MIT 6.1810 Operating System Engineering"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2022/10/08/MIT-6-1810-Operating-System-Engineering/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2022/10/08/MIT-6-1810-Operating-System-Engineering/" itemprop="commentCount"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>课程地址:<a target="_blank" rel="noopener" href="https://pdos.csail.mit.edu/6.1810/2022/index.html">https://pdos.csail.mit.edu/6.1810/2022/index.html</a><br>
 新坑，MIT 6.1810</p>
</blockquote>
<h1 id="61810-2022-lecture-1-os-overview"><a class="markdownIt-Anchor" href="#61810-2022-lecture-1-os-overview">#</a> 6.1810 2022 Lecture 1: O/S overview</h1>
<div class="tabs" id="lecture-1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#lecture-1-1">Overview</button></li><li class="tab"><button type="button" data-href="#lecture-1-2">Class structure</button></li><li class="tab"><button type="button" data-href="#lecture-1-3">Introduction to UNIX system calls</button></li><li class="tab"><button type="button" data-href="#lecture-1-4">examples</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="lecture-1-1"><h2 id="overview"><a class="markdownIt-Anchor" href="#overview">#</a> Overview</h2>
<p><span class="bubble-content">6.1810 goals</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">Understand operating system (O/S) design and implementation<br>Hands-on experience extending a small O/S<br>Hands-on experience writing systems software</span></span><br>
<span class="bubble-content">What is the purpose of an O/S?</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">Abstract the hardware for convenience and portability<br>Multiplex the hardware among many applications<br>Isolate applications in order to contain bugs<br>Allow sharing among cooperating applications<br>Control sharing for security<br>Don’t get in the way of high performance<br>Support a wide range of applications</span></span><br>
<span class="bubble-content">Organization: layered picture</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">[user/kernel diagram]<br>- user applications: vi，gcc，DB，&amp;c<br>- kernel services<br>- h/w: CPU，RAM，disk，net，&amp;c<br>we care a lot about the interfaces and internal kernal structure</span></span><br>
<span class="bubble-content">What services does ans O/S kernel typically provide?</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">process (a running program)<br>memory allocation<br>file contents<br>file names，directories<br>access control (security)<br>many others: users，IPC，network，time，terminals</span></span><br>
<span class="bubble-content">What’s the application / kernel interface?</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">“System calls&quot;<br>Examples，in C，from UNIX (e.g. Linux，macOS，FreeBSD):<br>    fd = open(out”，1);<br>    write(fd，“hello\n”，6);<br>    pid = fork();<br>There look like function calls but they aren’t&quot;</span></span><br>
<span class="bubble-content">Why is O/S design+implementation hard and interesting?</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">many design tensions:<br>- efficient vs abstract/portable/general-purpose<br>- powerful vs simple interfaces<br>- flexible vs secure<br>features interact: <br>    fd = open;<br>    fork()<br>uses are varied: laptops，smart-phones，cloud，virtual machines，embedded<br>evolving hardware: NVRAM，multi-core，fast networks<br>unforgiving environment: quirky h/w，hard to debug</span></span><br>
<span class="bubble-content">You’ll be glad you took this coourse if you…</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">care about what gose on under the hood<br>like infrastructure<br>need to track down bugs or security problems<br>care about high performance</span></span></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="lecture-1-2"><h2 id="class-structure"><a class="markdownIt-Anchor" href="#class-structure">#</a> Class structure</h2>
<p><span class="bubble-content">Online course information:</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#ec5830;"><a target="_blank" rel="noopener" href="https://pdos.csail.mit.edu/6.1810/">https://pdos.csail.mit.edu/6.1810/</a> – schedule，assignments，labs<br>Piazza – announcements，discussion，lab help</span></span><br>
<span class="bubble-content">Lectures</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#ec5830;">O/S ideas<br>case study of xv6，a small O/S，via code and xv6 book<br>lab background<br>O/S papers<br>submit a question about each reading，before lecture.</span></span><br>
<span class="bubble-content">Labs:</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#ec5830;">The point: hands-on experience<br>Mostly one week each.<br>Three kinds:<br>    Systems programming (due next week…)<br>    O/S primitives，e.g. thread switching.<br>    O/S kernel extensions to xv6，e.g. network.<br>Use piazza to ask/answer lab questions.<br>Discussion is great，but please do not look at others’ solutions!</span></span><br>
<span class="bubble-content">Grading:</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#ec5830;">70% labs，based on tests (the same tests you run).<br>20% lab check-oof meetings: we’ll ask you about randomly-selected labs.<br>10% home-work and class/piazza discussion.<br>No exams，no quizzes.<br>Note that most of the grade is from labs. Start them early!</span></span></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="lecture-1-3"><h2 id="introduction-to-unix-system-calls"><a class="markdownIt-Anchor" href="#introduction-to-unix-system-calls">#</a> Introduction to UNIX system calls</h2>
<details class="folding-tag" blue><summary> Introduction to UNIX system calls </summary>
              <div class='content'>
              <div class="note success simple"><p>Applications see the O/S via system calls; that interface will be a big focus.<br>let’s start by looking at how programs use system calls.<br>you’ll use these system calls in the first lab.<br>and extend and improve them in subsequent labs.<br>I’ll show some examples, and run them on xv6.<br>xv6 has similar structure to UNIX systems such as Linux.</p></div><details class="folding-tag" red><summary> but much simpler -- you'll be able to digest all of xv6 </summary>              <div class='content'>              <p>accompanying book explains how xv6 works, and why</p>              </div>            </details><details class="folding-tag" red><summary> why UNIX? </summary>              <div class='content'>              <p>open source, well documented, clean design, widely used<br>studying xv6 will help if you ever need to look inside Linux</p>              </div>            </details><details class="folding-tag" red><summary> xv6 has two roles in 6.1810: </summary>              <div class='content'>              <p>example of core functions: virtual memory, multi-core, interrupts, &amp;c<br>starting point for most of the labs</p>              </div>            </details><div class="note success simple"><p>xv6 runs on RISC-V, as in 6.004<br>you’ll run xv6 under the qemu machine emulator</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> copy.c </summary>
              <div class='content'>
              <p class='p red'>copy input to output</p><div class="note success simple"><p>read bytes from input, write them to the output</p></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">copy</span></span><br></pre></td></tr></table></figure><div class="note success simple"><p>copy.c is written in C<br>Kernighan and Ritchie (K&amp;R) book is good for learning C<br>you can find these example programs via the schedule on the web site</p></div><details class="folding-tag" red><summary> read() and write() are system calls </summary>              <div class='content'>              <div class="note success simple"><p><wavy>first</wavy> read()/write() argument is a “file descriptor” (fd)<br>passed to kernel to tell it which “open file” to read/write<br>must previously have been opened<br>an FD connects to a file/device/socket/&amp;c<br>a process can open many files, have many FDs<br>UNIX convention: fd 0 is “standard input”, 1 is “standard output”</p></div><div class="note success simple"><p><wavy>second</wavy> read() argument is a pointer to some memory into which to read</p></div><div class="note success simple"><p><wavy>third</wavy> argument is the number of bytes to read<br>read() may read less, but not more</p></div><div class="note success simple"><p><wavy>return value:</wavy> number of bytes actually read, or -1 for error</p></div><div class="note success simple"><p><wavy>note:</wavy> copy.c does not care about the format of the data<br>UNIX I/O is 8-bit bytes<br>interpretation is application-specific, e.g. database records, C source, &amp;c</p></div>              </div>            </details><div class="note red icon-padding disabled"><i class="note-icon fas fa-bullhorn"></i><p>where do file descriptors come from?</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> open.c </summary>
              <div class='content'>
              <p class='p red'>create a file</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">open</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> out</span></span><br></pre></td></tr></table></figure><div class="note success simple"><p>open() creates a file, <wavy>returns a file descriptor (or -1 for error)</wavy><br>FD is a small integer<br>FD indexes into a per-process table maintained by kernel<br>[user/kernel diagram]</p></div><span class="bubble-content">different processes have different FD name-spaces</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">i.e. FD 1 usually means different things to different processes</span></span><div class="note red icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>these examples ignore errors – don’t be this sloppy!</p></div><div class="note success simple"><p>Figure 1.2 in the xv6 book lists system call arguments/return<br>or look at UNIX man pages, e.g. “man 2 open”</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> what happens when a program calls a system call like open()? </summary>
              <div class='content'>
              <div class="note success simple"><p>looks like a function call, but it’s actually a special instruction<br>hardware saves some user registers<br>hardware increases privilege level<br>hardware jumps to a known “entry point” in the kernel<br>now running C code in the kernel<br>kernel calls system call implementation<br>sys_open() looks up name in file system<br>it might wait for the disk<br>it updates kernel data structures (file block cache, FD table)<br>restore user registers<br>reduce privilege level<br>jump back to calling point in the program, which resumes<br>we’ll see more detail later in the course</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> shell </summary>
              <div class='content'>
              <div class="note success simple"><p>I’ve been typing to UNIX’s command-line interface, the shell.<br>the shell prints the “$” prompts.<br>the shell lets you run UNIX command-line utilities<br>useful for system management, messing with files, development, scripting</p></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> &gt; out</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">grep x &lt; out</span></span><br></pre></td></tr></table></figure><div class="note success simple"><p>UNIX supports other styles of interaction too<br>window systems, GUIs, servers, routers, &amp;c.<br>but time-sharing via the shell was the original focus of UNIX.<br>we can exercise many system calls via the shell.</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> fork.c </summary>
              <div class='content'>
              <p class='p red'>create a new process</p><div class="note success simple"><p>the shell creates a new process for each command you type, e. g. for</p></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> hello</span></span><br></pre></td></tr></table></figure>the fork() system call creates a new process<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">fork</span></span><br></pre></td></tr></table></figure><div class="note success simple"><p>the kernel makes a copy of the calling process<br>instructions, data, registers, file descriptors, current directory<br>“parent” and “child” process<br>only difference: <emp>fork() returns a pid in parent, 0 in child a pid (process ID) is an interger,kernel gives each process a different pid</emp><br>thus:<br>fork.c’s “fork() returned” executes in <em>both</em> processes<br>the “if(pid == 0)” allows code to distinguish<br>ok, fork lets us create a new process</p></div><div class="note red icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>how can we run a program in that process?</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> exec.c </summary>
              <div class='content'>
              <p class='p red'>replace calling process with an executable file</p><div class="note success simple"><p>how does the shell run a program, e. g.</p></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> a b c</span></span><br></pre></td></tr></table></figure><div class="note success simple"><p>a program is stored in a file: instructions and initial memory created by the compiler and linker<br>so there’s a file called echo, containing instructions</p></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">exec</span></span></span><br></pre></td></tr></table></figure><div class="note success simple"><p>exec() replaces current process with an executable file<br>discards instructions and memory from the file<br>preserves file descriptors<br>exec(filename, argument-array)<br>argument-array holds command-line arguments; exec passes to main()<br>cat uesr/echo.c<br>echo.c shows how a program looks at its command-line arguments</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> forkexec.c </summary>
              <div class='content'>
              <p class='p red'>fork() a new process，exec() a program</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">forkexec</span></span><br></pre></td></tr></table></figure><div class="note success simple"><p>forkexec.c contains a common UNIX idiom:<br>fork() a child process<br>exec() a command in the child<br>parent wait()s for child to finish<br>the shell does fork/exec/wait for every command you type<br>after wait(), the shell prints the next prompt<br>to run in the background – &amp; – the shell skips the wait()<br>exit(status) -&gt; wait(&amp;status)<br>status convention: 0 = success, 1 = command encountered an error<br>note: the fork() copies, but exec() discards the copied memory<br>this may seem wasteful<br>you’ll transparently eliminate the copy in the “copy-on-write” lab</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> refirect.c </summary>
              <div class='content'>
              <p class='p red'>redirect the output of a command</p><div class="note success simple"><p>what does the shell do for this?</p></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> hello &gt; out</span></span><br></pre></td></tr></table></figure><div class="note success simple"><p>answer: fork, change FD 1 in child, exec echo</p></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">redirect</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> out</span></span><br></pre></td></tr></table></figure><div class="note success simple"><p>note: open() always chooses lowest unused FD; 1 due to close(1).<br>fork, FDs, and exec interact nicely to implement I/O redirection<br>separate fork-then-exec give child a chance to change FDs before exec FDs provide indirection<br>commands just use FDs 0 and 1, don’t have to know where they go exec preserves the FDs that sh set up<br>thus: only sh has to know about I/O redirection, not each program</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> design decisions </summary>
              <div class='content'>
              <div class="note success simple"><p>It’s worth asking “why” about design decisions:<br>Why these I/O and process abstractions?<br>Why not something else?<br>Why provide a file system?<br>Why not let programs ues the disk their own way?<br>Why FDs?<br>Why not pass a filename to write()?<br>Why are files streams of bytes, not disk blocks or formatted records?<br>Why not combine fork() and exec()?<br>The UNIX design works well, but we will see other designs!</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> pipe1.c </summary>
              <div class='content'>
              <p class='p red'>communicate through a pipe</p><div class="note success simple"><p>how does the shell implement</p></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> | grep x</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pipe1</span></span><br></pre></td></tr></table></figure><div class="note success simple"><p>an FD can refer to a “pipe”, as well as a file<br>the pipe() system call creates two FDs<br>read from the first FD<br>write to the seconnd FD<br>the hernel maintains a buffer for each pipe<br>[u/k diagram]<br>write() appends to the buffer<br>read() waits until there is data</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> pipe2.c </summary>
              <div class='content'>
              <p class='p red'>communicate between process</p><div class="note success simple"><p>pipes combine well with fork() to implement ls | grep x<br>shell creates a pipe,<br>then forks (twice),<br>then connects ls’s FD 1 to pipe’s write FD,<br>and grep’s FD 0 to the pipe<br>[diagram]</p></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pipe -- a simplified version</span></span><br></pre></td></tr></table></figure><div class="note success simple"><p>pipes are a separate abstraction, but combine well w/ fork()</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> list.c </summary>
              <div class='content'>
              <p class='p red'>list files in a directory</p><div class="note success simple"><p>how does ls get a list of the files in a directory?<br>you can open a directory and read it -&gt; file names<br>“.” is a pseudo-name for a process’s current directory<br>see ls.c for more details</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> Summary </summary>
              <div class='content'>
              <div class="note success simple"><p>We’ve looked at UNIX’s I/O, file system, and process abstractions.<br>The interfaces are simple – just integers and I/O buffers.<br>The abstractions combine well, e. g. for I/O rediretion.</p></div>
              </div>
            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="lecture-1-4"><div class="tabs" id="examples"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#examples-1">copy.c</button></li><li class="tab"><button type="button" data-href="#examples-2">echo.c</button></li><li class="tab"><button type="button" data-href="#examples-3">exec.c</button></li><li class="tab"><button type="button" data-href="#examples-4">fork.c</button></li><li class="tab"><button type="button" data-href="#examples-5">forkexec.c</button></li><li class="tab"><button type="button" data-href="#examples-6">list.c</button></li><li class="tab"><button type="button" data-href="#examples-7">open.c</button></li><li class="tab"><button type="button" data-href="#examples-8">pipe1.c</button></li><li class="tab"><button type="button" data-href="#examples-9">pipe2.c</button></li><li class="tab"><button type="button" data-href="#examples-10">redirect.c</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="examples-1"><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// copy.c: copy input to output.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line"><span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">64</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="type">int</span> n = read(<span class="number">0</span>, buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">    <span class="keyword">if</span>(n &lt;= <span class="number">0</span>)</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    write(<span class="number">1</span>, buf, n);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="examples-2"><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line"><span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; argc; i++)&#123;</span><br><span class="line">    write(<span class="number">1</span>, argv[i], <span class="built_in">strlen</span>(argv[i]));</span><br><span class="line">    <span class="keyword">if</span>(i + <span class="number">1</span> &lt; argc)&#123;</span><br><span class="line">      write(<span class="number">1</span>, <span class="string">&quot; &quot;</span>, <span class="number">1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      write(<span class="number">1</span>, <span class="string">&quot;\n&quot;</span>, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="examples-3"><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// exec.c: replace a process with an executable file</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line"><span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *argv[] = &#123; <span class="string">&quot;echo&quot;</span>, <span class="string">&quot;this&quot;</span>, <span class="string">&quot;is&quot;</span>, <span class="string">&quot;echo&quot;</span>, <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line">  exec(<span class="string">&quot;echo&quot;</span>, argv);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;exec failed!\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="examples-4"><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// fork.c: create a new process</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line"><span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> pid;</span><br><span class="line"></span><br><span class="line">  pid = fork();</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;fork() returned %d\n&quot;</span>, pid);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(pid == <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;child\n&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;parent\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="examples-5"><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// forkexec.c: fork then exec</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line"><span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> pid, status;</span><br><span class="line"></span><br><span class="line">  pid = fork();</span><br><span class="line">  <span class="keyword">if</span>(pid == <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="type">char</span> *argv[] = &#123; <span class="string">&quot;echo&quot;</span>, <span class="string">&quot;THIS&quot;</span>, <span class="string">&quot;IS&quot;</span>, <span class="string">&quot;ECHO&quot;</span>, <span class="number">0</span> &#125;;</span><br><span class="line">    exec(<span class="string">&quot;echo&quot;</span>, argv);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;exec failed!\n&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;parent waiting\n&quot;</span>);</span><br><span class="line">    wait(&amp;status);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the child exited with status %d\n&quot;</span>, status);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="examples-6"><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// list.c: list file names in the current directory</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dirent</span> &#123;</span></span><br><span class="line">  ushort inum;</span><br><span class="line">  <span class="type">char</span> name[<span class="number">14</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line"><span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> fd;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">dirent</span> <span class="title">e</span>;</span></span><br><span class="line"></span><br><span class="line">  fd = open(<span class="string">&quot;.&quot;</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">while</span>(read(fd, &amp;e, <span class="keyword">sizeof</span>(e)) == <span class="keyword">sizeof</span>(e))&#123;</span><br><span class="line">    <span class="keyword">if</span>(e.name[<span class="number">0</span>] != <span class="string">&#x27;\0&#x27;</span>)&#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, e.name);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="examples-7"><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// open.c: create a file, write to it.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/fcntl.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line"><span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> fd = open(<span class="string">&quot;out&quot;</span>, O_WRONLY | O_CREATE | O_TRUNC);</span><br><span class="line">  write(fd, <span class="string">&quot;ooo\n&quot;</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="examples-8"><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// pipe1.c: communication over a pipe</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line"><span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> fds[<span class="number">2</span>];</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">100</span>];</span><br><span class="line">  <span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// create a pipe, with two FDs in fds[0], fds[1].</span></span><br><span class="line">  pipe(fds);</span><br><span class="line">  </span><br><span class="line">  write(fds[<span class="number">1</span>], <span class="string">&quot;this is pipe1\n&quot;</span>, <span class="number">14</span>);</span><br><span class="line">  n = read(fds[<span class="number">0</span>], buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line"></span><br><span class="line">  write(<span class="number">1</span>, buf, n);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="examples-9"><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// pipe2.c: communication between two processes</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line"><span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n, pid;</span><br><span class="line">  <span class="type">int</span> fds[<span class="number">2</span>];</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">100</span>];</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// create a pipe, with two FDs in fds[0], fds[1].</span></span><br><span class="line">  pipe(fds);</span><br><span class="line"></span><br><span class="line">  pid = fork();</span><br><span class="line">  <span class="keyword">if</span> (pid == <span class="number">0</span>) &#123;</span><br><span class="line">    write(fds[<span class="number">1</span>], <span class="string">&quot;this is pipe2\n&quot;</span>, <span class="number">14</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    n = read(fds[<span class="number">0</span>], buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">    write(<span class="number">1</span>, buf, n);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="examples-10"><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/fcntl.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// redirect.c: run a command with output redirected</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line"><span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> pid;</span><br><span class="line"></span><br><span class="line">  pid = fork();</span><br><span class="line">  <span class="keyword">if</span>(pid == <span class="number">0</span>)&#123;</span><br><span class="line">    close(<span class="number">1</span>);</span><br><span class="line">    open(<span class="string">&quot;out&quot;</span>, O_WRONLY | O_CREATE | O_TRUNC);</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> *argv[] = &#123; <span class="string">&quot;echo&quot;</span>, <span class="string">&quot;this&quot;</span>, <span class="string">&quot;is&quot;</span>, <span class="string">&quot;redirected&quot;</span>, <span class="string">&quot;echo&quot;</span>, <span class="number">0</span> &#125;;</span><br><span class="line">    exec(<span class="string">&quot;echo&quot;</span>, argv);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;exec failed!\n&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    wait((<span class="type">int</span> *) <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<h1 id="lab-util-unix-utilities"><a class="markdownIt-Anchor" href="#lab-util-unix-utilities">#</a> Lab util: Unix utilities</h1>
<div class="tabs" id="lab:xv6-and-unix-utilities"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#lab:xv6-and-unix-utilities-1">Boot xv6(easy)</button></li><li class="tab"><button type="button" data-href="#lab:xv6-and-unix-utilities-2">sleep(easy)</button></li><li class="tab"><button type="button" data-href="#lab:xv6-and-unix-utilities-3">pingpong(easy)</button></li><li class="tab"><button type="button" data-href="#lab:xv6-and-unix-utilities-4">primes(moderate)/(hard)</button></li><li class="tab"><button type="button" data-href="#lab:xv6-and-unix-utilities-5">find(moderate)</button></li><li class="tab"><button type="button" data-href="#lab:xv6-and-unix-utilities-6">xargs(moderate)</button></li><li class="tab"><button type="button" data-href="#lab:xv6-and-unix-utilities-7">Optional challenge exercises</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="lab:xv6-and-unix-utilities-1"><details class="folding-tag" blue><summary> requirement </summary>
              <div class='content'>
              <div class="note success simple"><p>You can do these labs on an Athena machine or on your own computer. If you use your own computer, have a look at the <a target="_blank" rel="noopener" href="https://pdos.csail.mit.edu/6.1810/2022/tools.html">lab tools page</a> for setup tips.</p><p>If you use Athena, you must use an x86 machine; that is,  <code>uname -a</code>  should mention  <code>i386 GNU/Linux</code>  or  <code>i686 GNU/Linux</code>  or x86_64 GNU/Linux. You can log into a public Athena host with</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ssh -X athena.dialup.mit.edu</span><br></pre></td></tr></table></figure><p>We have set up the appropriate compilers and simulators for you on Athena. To use them, run</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">add -f 6.828</span><br></pre></td></tr></table></figure><p>You must run this command every time you log in (or add it to your  <code>~/.environment</code>  file). If you get obscure errors while compiling or running  <code>qemu</code> , check that you added the course locker.<br>Fetch the git repository for the xv6 source for the lab:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> git://g.csail.mit.edu/xv6-labs-2022</span></span><br><span class="line">Cloning into &#x27;xv6-labs-2022&#x27;...</span><br><span class="line">...</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> xv6-labs-2022</span></span><br></pre></td></tr></table></figure><p>The repo is setup so that git checkouts the  <code>util</code>  branch when cloning the repo.</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git status</span></span><br><span class="line">Onbranch util</span><br><span class="line">Your branch is up to date with &#x27;origin/util&#x27;.</span><br><span class="line"></span><br><span class="line">nothing to commit, working tree clean</span><br></pre></td></tr></table></figure><p>The xv6-labs-2022 repository differs slightly from the book’s xv6-riscv; it mostly adds some files. If you are curious look at the git log:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span></span></span><br></pre></td></tr></table></figure><p>The files you will need for this and subsequent lab assignments are distributed using the Git version control system. For each of the labs you will checkout (git checkout util) a version of xv6 tailored for that lab. To learn more about Git, take a look at the Git user’s manual, or, you may find this CS-oriented overview of Git useful. Git allows you to keep track of the changes you make to the code. For example, if you are finished with one of the exercises, and want to checkpoint your progress, you can commit your changes by running:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git commit -am <span class="string">&#x27;my solution for util lab exercise 1&#x27;</span></span></span><br><span class="line">Create commit 60d2135: my solution for util lab exercise 1</span><br><span class="line">    1 file changed, 1 insertions(+), 0 deletions(-)</span><br><span class="line"><span class="meta prompt_">$</span></span><br></pre></td></tr></table></figure><p>You can keep track of your changes by using the  <code>git diff</code>  command. Running  <code>git diff</code>  will display the changes to your code since your last commit, and  <code>git diff origin/util</code>  will display the changes relative to the initial util code. Here, origin/util is the name of the git branch with the initial code you downloaded for the class.<br>Build and run xv6:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make qemu</span></span><br></pre></td></tr></table></figure><p>If you type  <code>ls</code>  at the prompt, you should see output similar to the following:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span></span></span><br></pre></td></tr></table></figure><p>These are the files that  <code>mkfs</code>  includess in the initial file system; most are programs you can run. You just ran one of them:ls.<br>xv6 has no  <code>ps</code>  command, but, if you type <kbd>Ctrl</kbd> - <kbd>p</kbd>, the kernel will print information about each process. If you try it now, you’ll see two lines: one for  <code>init</code> , and one for  <code>sh</code> .<br>To quit qemu type: <kbd>Ctrl</kbd>-<kbd>a</kbd> <kbd>x</kbd> (press <kbd>Ctrl</kbd> and <kbd>a</kbd> at the same time, followed by <kbd>x</kbd>).</p></div><div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><h4 id="grading-and-hand-in-procedure"><a class="markdownIt-Anchor" href="#grading-and-hand-in-procedure">#</a> Grading and hand-in procedure</h4><p>You can run  <code>make grade</code>  to test your solutions with the grading program. The TAs will use the same grading program to assign your lab submission a grade. Separately, we will also have check-off meetings for labs(see <a target="_blank" rel="noopener" href="https://pdos.csail.mit.edu/6.1810/2022/general.html#grading">Grading policy</a>).<br>The lab code comes with GNU Make rules to make submission easier. After committing your final changes to the lab, type  <code>make handin</code>  to subtime your lab. For detailed instructions on how to submit see <a target="_blank" rel="noopener" href="https://pdos.csail.mit.edu/6.1810/2022/labs/util.html#submit">below</a>.</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> code </summary>
              <div class='content'>
              <p><span class='p center logo large'>关于实验</span></p><div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>因为阿里云服务器挂载网站并且是 centos 操作系统，虚拟机又会导致我的电脑卡顿，因而我选择了在云服务器利用 docker 容器安装 Ubuntu 完成整个实验。(后续会写 docker 学习文章，一定不鸽，咕咕咕)</p></div><div class="note success simple"><p>首先，自己配置好环境哈！<br>然后安装课程所需<a target="_blank" rel="noopener" href="https://pdos.csail.mit.edu/6.1810/2022/tools.html">软件</a><br>我的环境是 Ubuntu 20.04，因此运行命令</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get install git build-essential gdb-multiarch qemu-system-misc gcc-riscv64-linux-gnu binutils-riscv64-linux-gnu</span><br></pre></td></tr></table></figure><p>之后你可以按照上面的 note 中提供的 shell 命令去运行！<br>如果你不使用 Athena，请忽略前两条指令；请注意我在部分代码块中加入了预期的运行结果，你可以通过进行 <code>$</code>  区分。</p></div>
              </div>
            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="lab:xv6-and-unix-utilities-2"><details class="folding-tag" blue><summary> requirement </summary>
              <div class='content'>
              <div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>Implement the UNIX program  <code>sleep</code>  for xv6; your  <code>sleep</code>  should pause for a user-specified number of ticks. A tick is a notion of time defined dy the xv6 hernel, namely the time between two interrupts from the timer chip. Your solution should be in the file  <code>user/sleep.c</code> .</p></div><div class="note success simple"><p>Some hints:</p><ul><li>Before you start coding, read Chapter 1 of the <a href="">xv6 book</a>.</li><li>Look at some of the other programs in  <code>user/</code> (e.g.,  <code>user/echo.c</code> ,  <code>user/grep.c</code> ,and  <code>user/rm.c</code> ) to see how you can obtain the command-line arguments passed to a proggram.</li><li>If the user forgets to pass an argument, sleep should print an error message.</li><li>Use the system call  <code>sleep</code> .</li><li>See  <code>kernel/sysproc.c</code>  for the xv6 kernel code that implements the  <code>sleep</code>  system call (look for  <code>sys_sleep</code> ),  <code>user/user.h</code>  for the C definition of  <code>sleep</code>  callable from a user program, and  <code>user/usys.s</code>  for the assembler code that jumps from user code into the kernel for  <code>sleep</code> .</li><li><code>main</code>  should call  <code>exit(0)</code>  when it is done.</li><li>Add your  <code>sleep</code>  program to  <code>UPROGS</code>  in Makefile; once you’ve done that,  <code>make qemu</code>  will compile your program and you’ll be able to run it from the xv6 shell.</li><li>Look at Kernighan and Ritchie’s book <span class='p green'>The C programming language (second edition)</span>(K&amp;R) to learn about C.</li></ul><p>Run the program from the xv6 shell:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make qemu</span></span><br><span class="line">...</span><br><span class="line">init: starting sh</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sleep</span> 10</span></span><br><span class="line">(nothing happens for a little while)</span><br><span class="line"><span class="meta prompt_">$</span></span><br></pre></td></tr></table></figure><p>Your solution is correct if your program pauses when run as shown above. Run  <code>make grade</code>  to see if you indeed pass the sleep tests.<br>Note that  <code>make grade</code>  runs all tests, including the ones for the assignments below. If you want to run the grade tests for one assignment, type:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./grade-lab-util <span class="built_in">sleep</span></span></span><br></pre></td></tr></table></figure><p>This will run the grade tests that match “sleep”. Or, you can type:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make GRADEFLAGS=<span class="built_in">sleep</span> grade</span></span><br></pre></td></tr></table></figure><p>which does the same.</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> code </summary>
              <div class='content'>
              <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(argc != <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="number">2</span>, <span class="string">&quot;must only 1 argument for sleep\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> sleeptime = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;nothing happens for %d seconds\n&quot;</span>, sleeptime);</span><br><span class="line">    sleep(sleeptime);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
              </div>
            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="lab:xv6-and-unix-utilities-3"><details class="folding-tag" blue><summary> requirement </summary>
              <div class='content'>
              <div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>Write a program that uses UNIX system calls to “ping-pong” abyte between two processes over a pair of pipes, one for each direction. The parent should send a byte to the child; the child should print “<pid>:received ping”, where <pid> is its process ID, write the byte on the pipe to the parent, and exit; the parent should read the byte from the child, print “<pid>:received pong”, and exit. Your solution should be in the file  <code>user/pingpong.c</code></p></div><div class="note success simple"><p>Some hints:</p><ul><li>Use  <code>pipe</code>  to create a pipe.</li><li>Use  <code>fork</code>  to create a child.</li><li>Use  <code>read</code>  to from a pipe, and  <code>write</code>  to a pipe.</li><li>Use  <code>getpid</code>  to find the process ID of the calling process.</li><li>Add the program to `UPROGS’ in Makefile.</li><li>User programs on xv6 have a limited set of library functions available to them. You can see the list in  <code>user/user.h</code> ; the source (other than for system calls) is in  <code>user/ulib.c, user/printf.c,</code>  and  <code>user/umalloc.c</code> .</li></ul><p>Run the program from the xv6 shell and it should produce the following output:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make qemu</span></span><br><span class="line">...</span><br><span class="line">init: starting sh</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pingpong</span></span><br><span class="line">4: received ping</span><br><span class="line">3: received pong</span><br><span class="line"><span class="meta prompt_">$</span></span><br></pre></td></tr></table></figure><p>Your solution is correct if your program exchanges a byte between two processes and produces output as shown above.</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> code </summary>
              <div class='content'>
              <div class="note success simple"><p>首先，很明显，我们需要两条管道传递信息。<br>对于管道传参  <code>int pipefd[2]</code> ， <code>pipefd[0]</code>  为管道读端， <code>pipefd[1]</code>  为管道写端。<br>而且读取成功的情况下， <code>pipe</code>  函数会返回读取到的字节数。<br>记得使用 <code>fork</code>  创建子进程，以及使用 <code>read, write, close</code>  对管道进行操作。</p></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span>                                 </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd1[<span class="number">2</span>],fd2[<span class="number">2</span>];</span><br><span class="line">    <span class="type">char</span> buffer[] = &#123;<span class="string">&#x27;X&#x27;</span>&#125;;</span><br><span class="line">    pipe(fd1);</span><br><span class="line">    pipe(fd2);</span><br><span class="line">    <span class="keyword">if</span>(fork() == <span class="number">0</span>) &#123;</span><br><span class="line">        close(fd1[<span class="number">1</span>]);</span><br><span class="line">        close(fd2[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">if</span>(read(fd1[<span class="number">0</span>], buffer, <span class="keyword">sizeof</span>(buffer)) != <span class="keyword">sizeof</span>(buffer)) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;a--&gt;b read error!\n&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d: received ping\n&quot;</span>, getpid());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(write(fd2[<span class="number">1</span>], buffer, <span class="keyword">sizeof</span>(buffer)) != <span class="keyword">sizeof</span>(buffer)) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;b--&gt;a write error!\n&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        close(fd1[<span class="number">0</span>]);</span><br><span class="line">        close(fd2[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span>(write(fd1[<span class="number">1</span>], buffer, <span class="keyword">sizeof</span>(buffer)) != <span class="keyword">sizeof</span>(buffer)) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;a--&gt;b write error!\n&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(read(fd2[<span class="number">0</span>], buffer, <span class="keyword">sizeof</span>(buffer)) != <span class="keyword">sizeof</span>(buffer)) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;b--&gt;a read error!\n&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d: received pong\n&quot;</span>, getpid());</span><br><span class="line">        &#125;</span><br><span class="line">        wait(<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
              </div>
            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="lab:xv6-and-unix-utilities-4"><details class="folding-tag" blue><summary> requirement </summary>
              <div class='content'>
              <div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>Write a concurrent version of prime sieve using pipes. This idea is due to Doug Mcllroy, inventor of Unix pipes. The picture halfway down <a target="_blank" rel="noopener" href="http://swtch.com/~rsc/thread/">this page</a> and the surrounding text explain how to do it. Your solution should be in the file  <code>user/primes.c</code> .</p></div><div class="note success simple"><p>Your goal is to use  <code>pipe</code>  and  <code>fork</code>  to set up the pipeline. The first process feeds the numbers 2 through 35 into the pipeline. For each prime number, you will arrange to create one process that reads from its left neighbor over a pipe and writes to its right neighbor over another pipe. Since xv6 has limited number of file descriptors and processes, the first process can stop at 35.<br>Some hints:</p><ul><li>Be careful to close file descriptors that a process doesn’t need, because otherwise your program will run xv6 out of resources before the first process reaches 35.</li><li>Once the first process reaches 35, it should wait until the entire pipeline terminates, including all children, grandchildren, &amp;c. Thus the main primes process should only exit after all the output has been printed, and after all the other primes processes have exited.</li><li>Hint:  <code>read</code>  returns zero when the write-side of a pipe is closed.</li><li>It’s simplest to directly write 32-bit (4-byte)  <code>int</code> s to the pipes, rather than using formatted  <code>ASCII I/O</code> .</li><li>You should create the processes in the pipeline only as they are needed.</li><li>Add the program to  <code>UPROGS</code>  in Makefile.</li></ul><p>Your solution is correct if it implements a pipe-based sieve and produces the following output:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make qemu</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">primes</span></span><br></pre></td></tr></table></figure></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> code </summary>
              <div class='content'>
              <div class="note success simple"><p>这个实验的关键是利用 <code>pipe</code>  和 <code>fork</code> ，详细思想请看上个 <code>note</code>  给出的链接。<br>主要思想就是保证管道头部的数字为素数并删除在管道中是该数字倍数的数，其余的数写入下一个管道，如此反复。</p></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">func</span><span class="params">(<span class="type">int</span>* input, <span class="type">int</span> num)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(num == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> p[<span class="number">2</span>],i;</span><br><span class="line">    <span class="type">int</span> prime = *input;</span><br><span class="line">    <span class="type">int</span> temp;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;prime %d\n&quot;</span>, input);</span><br><span class="line">    pipe(p);</span><br><span class="line">    <span class="keyword">if</span>(fork() == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">            temp = *(input+i);</span><br><span class="line">            write(p[<span class="number">1</span>], (<span class="type">char</span>*)(&amp;temp), <span class="number">4</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    close(p[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span>(fork() == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">int</span> counter = <span class="number">0</span>;</span><br><span class="line">        <span class="type">char</span> buffer[<span class="number">4</span>];</span><br><span class="line">        <span class="keyword">while</span>(read(p[<span class="number">0</span>], buffer, <span class="number">4</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            temp = *((<span class="type">int</span>*)buffer);</span><br><span class="line">            <span class="keyword">if</span>(temp % prime != <span class="number">0</span>) &#123;</span><br><span class="line">                *input = temp;</span><br><span class="line">                input += <span class="number">1</span>;</span><br><span class="line">                counter++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        func(input - counter, counter);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    wait(<span class="number">0</span>);</span><br><span class="line">    wait(<span class="number">0</span>);</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> input[<span class="number">34</span>];</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>( ; i &lt; <span class="number">34</span>; i++) &#123;</span><br><span class="line">        input[i] = i + <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    func(input, <span class="number">34</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure>
              </div>
            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="lab:xv6-and-unix-utilities-5"><details class="folding-tag" blue><summary> requirement </summary>
              <div class='content'>
              <div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>Write a simple version of the UNIX find program: find all the files in a directory tree with a specific name. Your solution should be in the file  <code>user/find.c</code> .</p></div><div class="note success simple"><p>Some hints:</p><ul><li>Look at  <code>user/ls.c</code>  to see how to read directories.</li><li>Use recursion to allow find to descend into sub-directories.</li><li>Don’t recurse into “.” and “…”.</li><li>Changes to the file system persist across runs of qemu; to get a clean file system run  <code>make clean</code>  and then  <code>make qemu</code> .</li><li>You’ll need to use C strings. Have a look at K&amp;R (the C book), for example Section 5.5.</li><li>Note that == does not compare strings like in Python. Use strcmp() instead.</li><li>Add the program to  <code>UPROGS</code>  in Makefile.</li></ul><p>Your solution is correct if produces the following output (when the file system contains the files  <code>b, a/b</code>  and  <code>a/aa/b</code> ):</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make qemu</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> &gt; b</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> a</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> &gt; a/b</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> a/aa</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> &gt; a/aa/b</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">find . b</span></span><br><span class="line"><span class="meta prompt_">$</span></span><br></pre></td></tr></table></figure></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> code </summary>
              <div class='content'>
              <div class="note success simple"><p>根据提示，我们可以根据 <code>ls.c</code>  文件编写 <code>find.c</code>  文件。<br>find 和 ls 的异同</p><ul><li>find 需要找到指定目录中所有文件名为 filename 的文件，并打印路径 + 文件名</li><li>ls 打印出指定目录中的所有目录项</li><li>都需要输入 <code>path</code>  参数</li><li>都需要判断 <code>path</code>  参数所指向的文件类型</li><li>都需要遍历目录项并读取目录项的名字</li><li>find 还需要给定 <code>filename</code>  参数</li><li>find 需要递归遍历指定目录中的所有子目录</li></ul><p>因此，我们实现 find 需要在 ls 的基础上添加递归遍历子目录并查找指定文件名的操作，同时需要忽略掉 <code>.</code> 、 <code>..</code> ，防止重复递归。</p></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span>                                 </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/stat.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/fs.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line">        </span><br><span class="line"><span class="type">char</span>* <span class="title function_">fmtname</span><span class="params">(<span class="type">char</span> *path)</span> &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> buf[DIRSIZ + <span class="number">1</span>];</span><br><span class="line">    <span class="type">char</span> *p;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(p = path + <span class="built_in">strlen</span>(path); p &gt;= path &amp;&amp; *p != <span class="string">&#x27;/&#x27;</span>; p--);            </span><br><span class="line">    p++;    </span><br><span class="line">            </span><br><span class="line">    memmove(buf, p, <span class="built_in">strlen</span>(p) + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> buf;</span><br><span class="line">&#125;       </span><br><span class="line">    </span><br><span class="line"><span class="type">void</span> <span class="title function_">eq_print</span><span class="params">(<span class="type">char</span> *fileName, <span class="type">char</span> *findName)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">strcmp</span>(fmtname(fileName), findName) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, fileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br><span class="line">        </span><br><span class="line"><span class="type">void</span> <span class="title function_">find</span><span class="params">(<span class="type">char</span> *path, <span class="type">char</span>* name)</span> &#123;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">512</span>], *p;</span><br><span class="line">    <span class="type">int</span> fd;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">dirent</span> <span class="title">de</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">st</span>;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>((fd = open(path, <span class="number">0</span>)) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="number">2</span>, <span class="string">&quot;find: connot open %s\n&quot;</span>, path);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(fstat(fd, &amp;st) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="number">2</span>, <span class="string">&quot;find: connot stat %s\n&quot;</span>, path);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">switch</span>(st.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> T_FILE:</span><br><span class="line">        eq_print(path, name);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> T_DIR:</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strlen</span>(path) + <span class="number">1</span> + DIRSIZ +<span class="number">1</span> &gt; <span class="keyword">sizeof</span> buf) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;find: path too long\n&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">strcpy</span>(buf, path);</span><br><span class="line">        p = buf + <span class="built_in">strlen</span>(buf);</span><br><span class="line">        *p++ = <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">        <span class="keyword">while</span>(read(fd, &amp;de, <span class="keyword">sizeof</span>(de)) == <span class="keyword">sizeof</span>(de)) &#123;  </span><br><span class="line">            <span class="keyword">if</span>(de.inum == <span class="number">0</span> || de.inum == <span class="number">1</span> || <span class="built_in">strcmp</span>(de.name, <span class="string">&quot;.&quot;</span>) == <span class="number">0</span> || <span class="built_in">strcmp</span>(de.name, <span class="string">&quot;..&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">            memmove(p, de.name, <span class="built_in">strlen</span>(de.name));</span><br><span class="line">            p[<span class="built_in">strlen</span>(de.name)] = <span class="number">0</span>;</span><br><span class="line">            find(buf, name);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    close(fd);   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(argc != <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;please input: find &lt;path&gt; &lt;fileName&gt;\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    find(argv[<span class="number">1</span>], argv[<span class="number">2</span>]);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
              </div>
            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="lab:xv6-and-unix-utilities-6"><details class="folding-tag" blue><summary> requirement </summary>
              <div class='content'>
              <div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>Write a simple version of the UNIX xargs program: its arguments describe a command to run, it reads lines from the standard input, and it runs the command for each line, appending the line to the command’s arguments. Your solution should be in the file  <code>user/xargs.c</code> .</p></div><div class="note success simple"><p>The following example illustrates xarg’s behavior:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> hello too | xargs <span class="built_in">echo</span> <span class="built_in">bye</span></span></span><br><span class="line">bye hello too</span><br><span class="line"><span class="meta prompt_">$</span></span><br></pre></td></tr></table></figure><p>Note that the command here is “echo bye” and the additional arguments are “hello too”, making the command “echo bye hello too”, which outputs “bye hello too”.<br>Please note that xargs on UNIX makes an optimization where it will feed more than argument to the command at a time.<br>We don’t expect you to make this optimization. To make xargs on UNIX behave the way we want it to for this lab, please run it with the -n option set to 1. For instance</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">(<span class="built_in">echo</span> 1 : <span class="built_in">echo</span> 2) | xargs -n 1 <span class="built_in">echo</span></span></span><br><span class="line">1</span><br><span class="line">2</span><br></pre></td></tr></table></figure><p>Some hints:</p><ul><li>Use  <code>fork</code>  and  <code>exec</code>  to invoke the command on each line of input. Use  <code>wait</code>  in the parent to wait for the child to complete the command.</li><li>To read individual lines of input, read a character at a time until a newline (’\n’) appears.</li><li>lernel/param.h declars MAXARG, which may be useful if you need to declare an argv array.</li><li>Add the program to  <code>UPROGS</code>  in Makefile.</li><li>Changes to the file system persist across runs of qemu; to get a clean file system run make clean and then make qemu.</li></ul><p>xargs, find, and grep combine well:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">find . b | xargs grep hello</span></span><br></pre></td></tr></table></figure><p>will run “grep hello” on each file named b in the directories below “.”.<br>To test your solution for xargs, run the shell script <a target="_blank" rel="noopener" href="http://xargstest.sh">xargstest.sh</a>. Your solution is correct if it produces the following output:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make qemu</span></span><br><span class="line">...</span><br><span class="line">init: starting sh</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sh &lt; xargstest.sh</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">$ $ $ $ $ hello</span></span><br><span class="line">hello</span><br><span class="line">hello</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">$</span></span><br></pre></td></tr></table></figure><p>You may have to go back and fix bugs in your find program. The output has many $ because the xv6 shell doesn’t realize it is processing commands from a file instead of from the console, and prints a $ for each command in the file.</p></div>
              </div>
            </details>
<details class="folding-tag" blue><summary> code </summary>
              <div class='content'>
              <div class="note success simple"><p><code>xargs</code>  命令是一种管道命令， <code>|</code>  即为管道，他会将管道前面的命令的输出作为后面命令的标准输入。</p></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/types.h&quot;</span>                                 </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/stat.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;user/user.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;kernel/param.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> &#123;</span><br><span class="line">    <span class="type">char</span>* exec_argv[MAXARG], buf[<span class="number">512</span>];</span><br><span class="line">    <span class="type">int</span> len = <span class="number">0</span>, idx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i =<span class="number">1</span>; i &lt; argc; ++i)</span><br><span class="line">        exec_argv[i - <span class="number">1</span>] = argv[i];</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        idx = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>((len = read(<span class="number">0</span>, buf + idx, <span class="keyword">sizeof</span>(<span class="type">char</span>))) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(buf[idx] == <span class="string">&#x27;\n&#x27;</span>) &#123;</span><br><span class="line">                buf[idx] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ++idx;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(len == <span class="number">0</span> &amp;&amp; idx == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        exec_argv[argc - <span class="number">1</span>] = buf;</span><br><span class="line">        <span class="keyword">if</span>(fork() == <span class="number">0</span>) &#123;</span><br><span class="line">            exec(exec_argv[<span class="number">0</span>], exec_argv);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            wait(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
              </div>
            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="lab:xv6-and-unix-utilities-7"><details class="folding-tag" blue><summary> requirement </summary>
              <div class='content'>
              <ul><li>Write an uptime program that prints the uptime in terms of ticks using the  <code>uptime</code>  system call.(easy)</li><li>Support regular expressions in name matching for  <code>find. grep.c</code>  has some primitive support for regular expressions.(easy)</li><li>The xv6 shell(user/sh.c) is just another user program and you can improve it. It is a minimal shell and lacks many features found in real shell. For example, modify the shell to not print a $ when processing shell commands from a file(moderate), modify the shell to support wait(easy), modify the shell to support lists of commands, separated by “;”(moderate), modify the shell to support sub-shells by implementing “(” and “)” (moderate), modify the shell to support tab completion(easy), modify the shell to keep a history of passed shell commands(moderate), or anything else you would like your shell to do.(If you are very ambitious, you may have to modify the kermel to support the kernel features you need; xv6 doesn’t support mach.)</li></ul>
              </div>
            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></article><div class="business-center"><div class="business-card"><div class="business-flip"><div class="business-front"><div class="business-strip-bottom"></div><div class="business-strip-top"></div><img class="business-logo" width="80" height="80" src="/img/0.jpg" alt="cardcode"><div class="business-Invitation">Invitation</div><div class="business-chip"><div class="business-chip-line"></div><div class="business-chip-line"></div><div class="business-chip-line"></div><div class="business-chip-line"></div><div class="business-chip-main"></div></div><svg class="business-wave" viewBox="0 3.71 26.959 38.787" width="26.959" height="38.787" fill="white"><path d="M19.709 3.719c.266.043.5.187.656.406 4.125 5.207 6.594 11.781 6.594 18.938 0 7.156-2.469 13.73-6.594 18.937-.195.336-.57.531-.957.492a.9946.9946 0 0 1-.851-.66c-.129-.367-.035-.777.246-1.051 3.855-4.867 6.156-11.023 6.156-17.718 0-6.696-2.301-12.852-6.156-17.719-.262-.317-.301-.762-.102-1.121.204-.36.602-.559 1.008-.504z"></path><path d="M13.74 7.563c.231.039.442.164.594.343 3.508 4.059 5.625 9.371 5.625 15.157 0 5.785-2.113 11.097-5.625 15.156-.363.422-1 .472-1.422.109-.422-.363-.472-1-.109-1.422 3.211-3.711 5.156-8.551 5.156-13.843 0-5.293-1.949-10.133-5.156-13.844-.27-.309-.324-.75-.141-1.114.188-.367.578-.582.985-.542h.093z"></path><path d="M7.584 11.438c.227.031.438.144.594.312 2.953 2.863 4.781 6.875 4.781 11.313 0 4.433-1.828 8.449-4.781 11.312-.398.387-1.035.383-1.422-.016-.387-.398-.383-1.035.016-1.421 2.582-2.504 4.187-5.993 4.187-9.875 0-3.883-1.605-7.372-4.187-9.875-.321-.282-.426-.739-.266-1.133.164-.395.559-.641.984-.617h.094zM1.178 15.531c.121.02.238.063.344.125 2.633 1.414 4.437 4.215 4.437 7.407 0 3.195-1.797 5.996-4.437 7.406-.492.258-1.102.07-1.36-.422-.257-.492-.07-1.102.422-1.359 2.012-1.075 3.375-3.176 3.375-5.625 0-2.446-1.371-4.551-3.375-5.625-.441-.204-.676-.692-.551-1.165.122-.468.567-.785 1.051-.742h.094z"></path></svg><div class="business-card-number"><div class="business-section">x-17</div><div class="business-section">202111170521</div></div><div class="business-end"><span class="business-end-text">created:</span><span class="business-end-date">2021/11/17</span></div><div class="business-card-holder">Welcome to X</div><div class="business-master"><div class="business-circle business-master-red"></div><div class="business-circle business-master-yellow">   </div></div></div><div class="business-back"><div class="business-strip-black"></div><div class="business-ccv"><label>sitelink</label><div><a href="https://x-17.top">https://x-17.top</a></div></div><div class="business-terms"><p>月缺不改光，剑折不改钢</p><p>共矜然诺心，各负纵横志</p></div></div></div></div></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://x-17.top">潇十七</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://x-17.top/2022/10/08/MIT-6-1810-Operating-System-Engineering/">https://x-17.top/2022/10/08/MIT-6-1810-Operating-System-Engineering/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://x-17.top" target="_blank">潇十七</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MIT-6-1810/">MIT 6.1810</a><a class="post-meta__tags" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></div><div class="post_share"><div class="social-share" data-image="https://www.dmoe.cc/random.php" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">支持作者</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></button></div><audio id="coinAudio" src="https://assets.akilar.top@1.0.16/audio/coin.mp3"></audio><script defer="defer" src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/10/08/LeetCode/870-%E4%BC%98%E5%8A%BF%E6%B4%97%E7%89%8C/"><img class="prev-cover" src="https://img.xjh.me/random_img.php" onerror="onerror=null;src='/img/l/0072Vf1pgy1foxkjhrf2qj31hc0u01d4.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">870. 优势洗牌</div></div></a></div><div class="next-post pull-right"><a href="/2022/10/09/LeetCode/856-%E6%8B%AC%E5%8F%B7%E7%9A%84%E5%88%86%E6%95%B0/"><img class="next-cover" src="https://api.mtyqx.cn/tapi/random.php" onerror="onerror=null;src='/img/l/0072Vf1pgy1foxkjhrf2qj31hc0u01d4.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">856. 括号的分数</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/0.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">潇十七</div><div class="author-info__description">可生活不是电影，我也少了点运气</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">165</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/2932437988"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/2932437988" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2932437988@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#61810-2022-lecture-1-os-overview"><span class="toc-text"> 6.1810 2022 Lecture 1: O&#x2F;S overview</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#overview"><span class="toc-text"> Overview</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#class-structure"><span class="toc-text"> Class structure</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#introduction-to-unix-system-calls"><span class="toc-text"> Introduction to UNIX system calls</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lab-util-unix-utilities"><span class="toc-text"> Lab util: Unix utilities</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#grading-and-hand-in-procedure"><span class="toc-text"> Grading and hand-in procedure</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/12/30/855-%E8%80%83%E5%9C%BA%E5%B0%B1%E5%BA%A7/" title="855. 考场就座"><img src="https://api.yimian.xyz/img" onerror="this.onerror=null;this.src='/img/l/0072Vf1pgy1foxkjhrf2qj31hc0u01d4.jpg'" alt="855. 考场就座"/></a><div class="content"><a class="title" href="/2022/12/30/855-%E8%80%83%E5%9C%BA%E5%B0%B1%E5%BA%A7/" title="855. 考场就座">855. 考场就座</a><time datetime="2022-12-30T08:11:43.000Z" title="发表于 2022-12-30 16:11:43">2022-12-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/29/LeetCode/2032-%E8%87%B3%E5%B0%91%E5%9C%A8%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%BB%84%E4%B8%AD%E5%87%BA%E7%8E%B0%E7%9A%84%E5%80%BC/" title="2032. 至少在两个数组中出现的值"><img src="https://api.mtyqx.cn/api/random.php" onerror="this.onerror=null;this.src='/img/l/0072Vf1pgy1foxkjhrf2qj31hc0u01d4.jpg'" alt="2032. 至少在两个数组中出现的值"/></a><div class="content"><a class="title" href="/2022/12/29/LeetCode/2032-%E8%87%B3%E5%B0%91%E5%9C%A8%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%BB%84%E4%B8%AD%E5%87%BA%E7%8E%B0%E7%9A%84%E5%80%BC/" title="2032. 至少在两个数组中出现的值">2032. 至少在两个数组中出现的值</a><time datetime="2022-12-29T09:38:29.000Z" title="发表于 2022-12-29 17:38:29">2022-12-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/28/LeetCode/1750-%E5%88%A0%E9%99%A4%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%A4%E7%AB%AF%E7%9B%B8%E5%90%8C%E5%AD%97%E7%AC%A6%E5%90%8E%E7%9A%84%E6%9C%80%E7%9F%AD%E9%95%BF%E5%BA%A6/" title="1750. 删除字符串两端相同字符后的最短长度"><img src="https://img.xjh.me/random_img.php" onerror="this.onerror=null;this.src='/img/l/0072Vf1pgy1foxkjhrf2qj31hc0u01d4.jpg'" alt="1750. 删除字符串两端相同字符后的最短长度"/></a><div class="content"><a class="title" href="/2022/12/28/LeetCode/1750-%E5%88%A0%E9%99%A4%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%A4%E7%AB%AF%E7%9B%B8%E5%90%8C%E5%AD%97%E7%AC%A6%E5%90%8E%E7%9A%84%E6%9C%80%E7%9F%AD%E9%95%BF%E5%BA%A6/" title="1750. 删除字符串两端相同字符后的最短长度">1750. 删除字符串两端相同字符后的最短长度</a><time datetime="2022-12-28T09:12:46.000Z" title="发表于 2022-12-28 17:12:46">2022-12-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/27/LeetCode/2027-%E8%BD%AC%E6%8D%A2%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9C%80%E5%B0%91%E6%93%8D%E4%BD%9C%E6%AC%A1%E6%95%B0/" title="2027. 转换字符串的最少操作次数"><img src="https://api.yimian.xyz/img" onerror="this.onerror=null;this.src='/img/l/0072Vf1pgy1foxkjhrf2qj31hc0u01d4.jpg'" alt="2027. 转换字符串的最少操作次数"/></a><div class="content"><a class="title" href="/2022/12/27/LeetCode/2027-%E8%BD%AC%E6%8D%A2%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%9C%80%E5%B0%91%E6%93%8D%E4%BD%9C%E6%AC%A1%E6%95%B0/" title="2027. 转换字符串的最少操作次数">2027. 转换字符串的最少操作次数</a><time datetime="2022-12-27T09:20:00.000Z" title="发表于 2022-12-27 17:20:00">2022-12-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/26/LeetCode/1759-%E7%BB%9F%E8%AE%A1%E5%90%8C%E6%9E%84%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%95%B0%E7%9B%AE/" title="1759. 统计同构子字符串的数目"><img src="https://api.mtyqx.cn/tapi/random.php" onerror="this.onerror=null;this.src='/img/l/0072Vf1pgy1foxkjhrf2qj31hc0u01d4.jpg'" alt="1759. 统计同构子字符串的数目"/></a><div class="content"><a class="title" href="/2022/12/26/LeetCode/1759-%E7%BB%9F%E8%AE%A1%E5%90%8C%E6%9E%84%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%95%B0%E7%9B%AE/" title="1759. 统计同构子字符串的数目">1759. 统计同构子字符串的数目</a><time datetime="2022-12-26T08:59:06.000Z" title="发表于 2022-12-26 16:59:06">2022-12-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022  <i id="heartbeat" class="fa fas fa-heartbeat"></i> 潇十七</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><a class="icon-V hidden" onclick="switchNightMode()" title="浅色和深色模式转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><button class="share" type="button" title="分享链接" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'W7TYgZjPQjBzAGpjVzFz5Eji-gzGzoHsz',
      appKey: '2JxSeX06m4IX71pBgHSW0UAa',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer src="/live2d-widget/autoload.js"></script><script defer src="/js/mo_tags.js"></script><script defer src="/js/mo_fairyDustCursor.js"></script><script async src="/js/sakura.js"></script><script src="/js/sun_moon.js" async></script><script src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script type="text/javascript" src="/js/share.js"></script><canvas id="universe"></canvas><script src="/js/universe.js"></script><div class="aplayer no-destroy" data-id="5183531430" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><script async src="/js/grayscale.js"></script><script async src="//at.alicdn.com/t/c/font_3689038_kvnb4fq6wdr.js"></script><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start -->
  <script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://api.icodeq.com/api/github?2932437988";
            var git_color =['#ebedf0', '#fdcdec', '#fc9bd9', '#fa6ac5', '#f838b2', '#f5089f', '#c4067e', '#92055e', '#540336', '#48022f', '#30021f'];
            var git_user ="2932437988";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/'){
                console.log('已挂载github calendar')
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><script data-pjax>function history_calendar_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>那年今日</span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>';
                console.log('已挂载history_calendar')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='all'|| 'all' ==='all')){

            history_calendar_injector_config()
        } </script><script data-pjax  src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script><script data-pjax>
  function butterfly_clock_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://npm.elemecdn.com/hexo-butterfly-clock/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_injector_config();
  }
  </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax src="https://npm.elemecdn.com/hexo-butterfly-clock/lib/clock.min.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><div id="ghbdages" style="overflow:hidden;max-height:60px;height:auto;text-align:center;margin-top:10px"><div class="swiper-wrapper"><div class="swiper-slide"><a class="github-badge" target="_blank" href="https://beian.miit.gov.cn" style="margin-inline:5px" title="本站已在工信部备案，备案号辽ICP备2021011309号-1"><img src="https://img.shields.io/badge/%E8%BE%BDICP%E5%A4%87-2021011309%E5%8F%B7--1-yellow?style=flat&amp;logo=data:image/png;base64,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" alt=""/></a><a class="github-badge" target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44031102000684" style="margin-inline:5px" title="本站已在公安部备案，备案号粤公网安备 44031102000684号"><img src="https://img.shields.io/badge/%E7%B2%A4%E5%85%AC%E7%BD%91%E5%AE%89%E5%A4%87-44031102000684%E5%8F%B7-yellow?style=flat&amp;logo=data:image/png;base64,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" alt=""/></a></div><div class="swiper-slide"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v6.3.0"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v4.4.0"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a></div><div class="swiper-slide"><a class="github-badge" target="_blank" href="https://aliyun.com/" style="margin-inline:5px" title="本站采用双线部署，国内线路托管于阿里云"><img src="https://img.shields.io/badge/Hosted-aliyun-orange?style=flat&amp;logo=Alibaba Cloud" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本站采用双线部署，国外线路托管于Github"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a></div><div class="swiper-slide"><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></div></div></div><style>a.github-badge:hover:before {display:none}</style>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-footer-beautify/lib/swiperbdage_init.min.js"></script><script async src="//at.alicdn.com/t/c/font_3689038_kvnb4fq6wdr.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '1s');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '2');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://unpkg.zhimg.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://unpkg.zhimg.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --></body></html>